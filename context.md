SQL error
This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (psycopg.errors.NotNullViolation) null value in column "rating_dist_1" of relation "books" violates not-null constraint
DETAIL:  Failing row contains (1, W.C. Fields: A Life on Film, null, null, null, null, null, null, 2026-02-18 13:59:11.774647+00, null, 1984, https://images.gr-assets.com/books/1310220028m/5333265.jpg, 1950356, null, null).
[SQL: INSERT INTO books (title, description, image_url, publication_year, book_id, author_id, similar_books) VALUES (%(title)s::VARCHAR, %(description)s::VARCHAR, %(image_url)s::VARCHAR, %(publication_year)s::INTEGER, %(book_id)s::VARCHAR, %(author_id)s::VARCHAR, %(similar_books)s::VARCHAR) RETURNING books.id, books.created_at]
[parameters: {'title': 'W.C. Fields: A Life on Film', 'description': None, 'image_url': 'https://images.gr-assets.com/books/1310220028m/5333265.jpg', 'publication_year': 1984, 'book_id': '1950356', 'author_id': None, 'similar_books': None}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)



Failed to process row: {'language_code': 'eng', 'popular_shelves': [{'count': '20', 'name': 'to-read'}, {'count': '2', 'name': 'horror'}, {'count': '2', 'name': 'fiction'}, {'count': '1', 'name': 'crime-detective-mystery'}, {'count': '1', 'name': 'your-library'}, {'count': '1', 'name': 'mental-health'}, {'count': '1', 'name': 'fictionalized-true-crime'}, {'count': '1', 'name': 'zcnstnlzms'}, {'count': '1', 'name': 'shelfie-app-books'}, {'count': '1', 'name': 'noir'}, {'count': '1', 'name': 'mystery'}, {'count': '1', 'name': 'favorite-headtrips'}, {'count': '1', 'name': 'hold'}], 'similar_books': [], 'description': '', 'format': 'Paperback', 'link': 'https://www.goodreads.com/book/show/1038906.Wisteria_Cottage', 'authors': [{'author_id': '823978', 'role': ''}], 'publisher': 'Arbor House', 'num_pages': 210, 'isbn13': '9780877957102', 'publication_year': 1985, 'url': 'https://www.goodreads.com/book/show/1038906.Wisteria_Cottage', 'image_url': 'https://images.gr-assets.com/books/1455317238m/1038906.jpg', 'book_id': 1677641, 'work_id': '1025267', 'title': 'Wisteria Cottage', 'num_interactions': 6, 'num_read': 2, 'num_ratings': 2, 'num_reviews': 2}
Traceback (most recent call last):
  File "/Users/borisgans/IE/chatbots/project/BookDB/bookdb/datasets/processor.py", line 348, in import_books
    book = BookCRUD.create(session, **book_data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/borisgans/IE/chatbots/project/BookDB/bookdb/datasets/crud.py", line 103, in create
    session.flush()
  File "/Users/borisgans/IE/chatbots/project/BookDB/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/Users/borisgans/IE/chatbots/project/BookDB/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4423, in _flush
    flush_context.transaction = transaction = self._autobegin_t()._begin()
                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _begin
  File "/Users/borisgans/IE/chatbots/project/BookDB/.venv/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 101, in _go
    self._raise_for_prerequisite_state(fn.__name__, current_state)
  File "/Users/borisgans/IE/chatbots/project/BookDB/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 971, in _raise_for_prerequisite_state
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (psycopg.errors.NotNullViolation) null value in column "rating_dist_1" of relation "books" violates not-null constraint
DETAIL:  Failing row contains (1, W.C. Fields: A Life on Film, null, null, null, null, null, null, 2026-02-18 13:59:11.774647+00, null, 1984, https://images.gr-assets.com/books/1310220028m/5333265.jpg, 1950356, null, null).
[SQL: INSERT INTO books (title, description, image_url, publication_year, book_id, author_id, similar_books) VALUES (%(title)s::VARCHAR, %(description)s::VARCHAR, %(image_url)s::VARCHAR, %(publication_year)s::INTEGER, %(book_id)s::VARCHAR, %(author_id)s::VARCHAR, %(similar_books)s::VARCHAR) RETURNING books.id, books.created_at]
[parameters: {'title': 'W.C. Fields: A Life on Film', 'description': None, 'image_url': 'https://images.gr-assets.com/books/1310220028m/5333265.jpg', 'publication_year': 1984, 'book_id': '1950356', 'author_id': None, 'similar_books': None}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
Failed to process row: {'language_code': 'nl', 'popular_shelves': [{'count': '114', 'name': 'to-read'}, {'count': '6', 'name': 'dutch'}, {'count': '5', 'name': 'nederlands'}, {'count': '4', 'name': 'literature'}, {'count': '3', 'name': 'read-2016'}, {'count': '3', 'name': 'books-i-own'}, {'count': '3', 'name': 'owned'}, {'count': '2', 'name': 'read-in-2017'}, {'count': '2', 'name': 'literatuur'}, {'count': '2', 'name': 'dutch-literature'}, {'count': '2', 'name': 'fictie'}, {'count': '2', 'name': 'read-in-2015'}, {'count': '2', 'name': 'debuten'}, {'count': '2', 'name': 'fiction'}, {'count': '1', 'name': 'roman'}, {'count': '1', 'name': 'ebook'}, {'count': '1', 'name': 'boekenkast-te-lezen'}, {'count': '1', 'name': 'uni'}, {'count': '1', 'name': 'vrouw'}, {'count': '1', 'name': 'monthly-reading-list'}, {'count': '1', 'name': 'library-book'}, {'count': '1', 'name': 'boekenwurm-2017'}, {'count': '1', 'name': 'van-eigen-bodem'}, {'count': '1', 'name': 'gelezen-met-bliyoo'}, {'count': '1', 'name': 'female-authors'}, {'count': '1', 'name': 'boekenwurm'}, {'count': '1', 'name': 'bibliotheek-nl'}, {'count': '1', 'name': 'to-borrow'}, {'count': '1', 'name': 'nederlandse-literatuur'}, {'count': '1', 'name': 'lezen-deze-zomer'}, {'count': '1', 'name': 'mijn-eigen-boekenkast'}, {'count': '1', 'name': 'gelezen'}, {'count': '1', 'name': 'to-read-e-book'}, {'count': '1', 'name': 'kobo-plus'}, {'count': '1', 'name': 'boekenplank-misschien-lezen'}, {'count': '1', 'name': 'lc5'}, {'count': '1', 'name': 'dutch-flemish-literature'}, {'count': '1', 'name': 'readharder-2017'}, {'count': '1', 'name': 'e-books'}, {'count': '1', 'name': 'read-in-2016'}, {'count': '1', 'name': 'adult'}, {'count': '1', 'name': '2017-read'}, {'count': '1', 'name': 'dutch-reads'}, {'count': '1', 'name': 'via-bookmate'}, {'count': '1', 'name': 'dutch-lit'}, {'count': '1', 'name': 'relaties'}, {'count': '1', 'name': 'paper-books'}, {'count': '1', 'name': '1-star'}, {'count': '1', 'name': 'school'}, {'count': '1', 'name': 'owned-books'}, {'count': '1', 'name': '2016-book-challenge'}, {'count': '1', 'name': 'niet-uitgelezen'}, {'count': '1', 'name': 'parijs'}, {'count': '1', 'name': 'het-verleden'}, {'count': '1', 'name': 'ebooks'}, {'count': '1', 'name': '4-or-5-stars'}, {'count': '1', 'name': 'litclub'}, {'count': '1', 'name': 'leenexemplaar'}, {'count': '1', 'name': 'ereader'}, {'count': '1', 'name': 'to-read-don-t-own-book'}, {'count': '1', 'name': '1985-and-after'}, {'count': '1', 'name': 'school-project-feminism'}, {'count': '1', 'name': 'read-2015'}, {'count': '1', 'name': 'favourites'}, {'count': '1', 'name': 'over-de-liefde'}, {'count': '1', 'name': 'neu-2015'}, {'count': '1', 'name': 'reads-for-school'}, {'count': '1', 'name': '1'}, {'count': '1', 'name': 'debute'}, {'count': '1', 'name': 'bloemlezing-wim-brands'}, {'count': '1', 'name': 'female-author'}, {'count': '1', 'name': 'nederlands-modern'}, {'count': '1', 'name': 'neuerscheinungen-2015'}, {'count': '1', 'name': 'literaire-debuten'}, {'count': '1', 'name': 'read_2015'}, {'count': '1', 'name': 'leestweeps-twitter-leesclub'}, {'count': '1', 'name': 'all-books-2015'}, {'count': '1', 'name': 'nederlands-dutch'}, {'count': '1', 'name': 'nederlandse-romans'}, {'count': '1', 'name': 'to-buy'}, {'count': '1', 'name': 'to-read-some-day'}, {'count': '1', 'name': 'library'}, {'count': '1', 'name': 'kobo'}, {'count': '1', 'name': 'dutch-writers'}, {'count': '1', 'name': 'goudenuil2015'}, {'count': '1', 'name': 'libris-2015'}, {'count': '1', 'name': 'on-bookshelf'}, {'count': '1', 'name': 'literature-2014'}, {'count': '1', 'name': 'to-read-2015'}, {'count': '1', 'name': 'leesexemplaar'}, {'count': '1', 'name': 'gerecenseerd'}, {'count': '1', 'name': 'novels'}], 'similar_books': [345821, 345820, 456059, 310178, 310177, 310182, 182671, 552126, 361448, 182621, 310184, 52579, 796865, 360742, 793272, 538523], 'description': 'De comfortabele routine van Olivier, professor in de kunstgeschiedenis aan de Sorbonne, raakt ontwricht wanneer zijn baas hem vraagt om als mentor van een uitwisselingsstudente op te treden. De stugge Nederlandse rakelt een geschiedenis op die Olivier had willen vergeten, maar die tegelijk het kostbaarste is dat hij bezit.\nTegen beter weten in zoekt hij toenadering tot de studente, en geeft haar een advies dat hij zelf nooit heeft opgevolgd. Maar Fie heeft haar eigen leven. Zij worstelt met een onmogelijke keuze: streven naar het allerhoogste, en eraan kapot gaan - of nooit beginnen om niet te falen. Ze voert koppig verzet tegen haar eigen levensangst en daagt Olivier uit hetzelfde te doen.\nDe hemel boven Parijsgaat over de leugens die wij voor onszelf bedenken om niet te hoeven doen wat we het meest verlangen. Bovendien is het een van de meest opvallende liefdesverhalen van de Nederlandse literatuur van nu, en een betoverende entree van een jonge auteur.', 'format': 'Paperback', 'link': 'https://www.goodreads.com/book/show/22677829-de-hemel-boven-parijs', 'authors': [{'author_id': '8368515', 'role': ''}], 'publisher': 'Cossee', 'num_pages': 222, 'isbn13': '9789059364974', 'publication_year': 2014, 'url': 'https://www.goodreads.com/book/show/22677829-de-hemel-boven-parijs', 'image_url': 'https://images.gr-assets.com/books/1413214453m/22677829.jpg', 'book_id': 355781, 'work_id': '42188375', 'title': 'De hemel boven Parijs', 'num_interactions': 71, 'num_read': 37, 'num_ratings': 33, 'num_reviews': 9}
Traceback (most recent call last):
  File "/Users/borisgans/IE/chatbots/project/BookDB/bookdb/datasets/processor.py", line 348, in import_books
    book = BookCRUD.create(session, **book_data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/borisgans/IE/chatbots/project/BookDB/bookdb/datasets/crud.py", line 103, in create
    session.flush()
  File "/Users/borisgans/IE/chatbots/project/BookDB/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/Users/borisgans/IE/chatbots/project/BookDB/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4423, in _flush
    flush_context.transaction = transaction = self._autobegin_t()._begin()
                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _begin
  File "/Users/borisgans/IE/chatbots/project/BookDB/.venv/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 101, in _go
    self._raise_for_prerequisite_state(fn.__name__, current_state)
  File "/Users/borisgans/IE/chatbots/project/BookDB/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 971, in _raise_for_prerequisite_state
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (psycopg.errors.NotNullViolation) null value in column "rating_dist_1" of relation "books" violates not-null constraint
DETAIL:  Failing row contains (1, W.C. Fields: A Life on Film, null, null, null, null, null, null, 2026-02-18 13:59:11.774647+00, null, 1984, https://images.gr-assets.com/books/1310220028m/5333265.jpg, 1950356, null, null).
[SQL: INSERT INTO books (title, description, image_url, publication_year, book_id, author_id, similar_books) VALUES (%(title)s::VARCHAR, %(description)s::VARCHAR, %(image_url)s::VARCHAR, %(publication_year)s::INTEGER, %(book_id)s::VARCHAR, %(author_id)s::VARCHAR, %(similar_books)s::VARCHAR) RETURNING books.id, books.created_at]
[parameters: {'title': 'W.C. Fields: A Life on Film', 'description': None, 'image_url': 'https://images.gr-assets.com/books/1310220028m/5333265.jpg', 'publication_year': 1984, 'book_id': '1950356', 'author_id': None, 'similar_books': None}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
Failed to process row: {'language_code': 'eng', 'popular_shelves': [{'count': '44', 'name': 'to-read'}, {'count': '2', 'name': 'currently-reading'}, {'count': '1', 'name': 'regular-copies'}, {'count': '1', 'name': 'ww2'}, {'count': '1', 'name': 'war'}, {'count': '1', 'name': 'stand-alone-novel'}, {'count': '1', 'name': 'novel'}, {'count': '1', 'name': 'non-fiction'}, {'count': '1', 'name': 'modern-classic'}, {'count': '1', 'name': 'memoir'}, {'count': '1', 'name': 'literary-nonfiction'}, {'count': '1', 'name': 'literary'}, {'count': '1', 'name': 'history'}, {'count': '1', 'name': 'historical-nonfiction'}, {'count': '1', 'name': 'german-literature'}, {'count': '1', 'name': 'fascism'}, {'count': '1', 'name': 'european-literature'}, {'count': '1', 'name': 'european-history'}, {'count': '1', 'name': 'contemporary'}, {'count': '1', 'name': 'classic'}, {'count': '1', 'name': 'autobiography'}, {'count': '1', 'name': 'adult-nonfiction'}, {'count': '1', 'name': '20th-century'}, {'count': '1', 'name': 'studeer-raam-links-2'}, {'count': '1', 'name': 'nf-history-politics'}, {'count': '1', 'name': 'wo2'}, {'count': '1', 'name': 'nazi-germany-1933-1945'}, {'count': '1', 'name': 'geschiedenis'}, {'count': '1', 'name': 'studeerk-raamkast-links'}, {'count': '1', 'name': 'josef'}, {'count': '1', 'name': 'paper_nl'}, {'count': '1', 'name': 'nf-history'}, {'count': '1', 'name': 'nf-biography'}, {'count': '1', 'name': 'biography-memoir'}, {'count': '1', 'name': 'exist'}, {'count': '1', 'name': 'wwii'}, {'count': '1', 'name': 'uni'}, {'count': '1', 'name': 'crime'}, {'count': '1', 'name': 'celebrities'}, {'count': '1', 'name': 'histoire'}, {'count': '1', 'name': 'library'}, {'count': '1', 'name': 'to-borrow-ulb'}, {'count': '1', 'name': 'political-figures'}, {'count': '1', 'name': 'nazi'}, {'count': '1', 'name': 'germany'}, {'count': '1', 'name': 'biography'}, {'count': '1', 'name': 'no-isbn'}, {'count': '1', 'name': 'storia-contemporanea'}, {'count': '1', 'name': 'storia'}, {'count': '1', 'name': 'usato'}, {'count': '1', 'name': 'rari'}, {'count': '1', 'name': 'nazismo'}, {'count': '1', 'name': 'english'}, {'count': '1', 'name': 'lingua-inglese'}, {'count': '1', 'name': 'goebbels'}, {'count': '1', 'name': 'biografia'}], 'similar_books': [], 'description': 'Coming generations will ask themselves how it was possible that millions of people, victims of an artificially induced enthusiasm, could be moved to do the very things which led to their own ruin. The answer could be given in hundreds of thousands of words, but, if it were expressed in one word alone, that word would be: Goebbels.', 'format': 'Paperback', 'link': 'https://www.goodreads.com/book/show/18528198-joseph-goebbels', 'authors': [{'author_id': '118353', 'role': ''}], 'publisher': 'Fonthill Media', 'num_pages': 400, 'isbn13': '9781781553237', 'publication_year': 2015, 'url': 'https://www.goodreads.com/book/show/18528198-joseph-goebbels', 'image_url': 'https://images.gr-assets.com/books/1380492924m/18528198.jpg', 'book_id': 946216, 'work_id': '15791343', 'title': 'Joseph Goebbels', 'num_interactions': 2, 'num_read': 1, 'num_ratings': 1, 'num_reviews': 1}
Traceback (most recent call last):
  File "/Users/borisgans/IE/chatbots/project/BookDB/bookdb/datasets/processor.py", line 348, in import_books
    book = BookCRUD.create(session, **book_data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/borisgans/IE/chatbots/project/BookDB/bookdb/datasets/crud.py", line 103, in create
    session.flush()
  File "/Users/borisgans/IE/chatbots/project/BookDB/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/Users/borisgans/IE/chatbots/project/BookDB/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4423, in _flush
    flush_context.transaction = transaction = self._autobegin_t()._begin()
                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _begin
  File "/Users/borisgans/IE/chatbots/project/BookDB/.venv/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 101, in _go
    self._raise_for_prerequisite_state(fn.__name__, current_state)
  File "/Users/borisgans/IE/chatbots/project/BookDB/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 971, in _raise_for_prerequisite_state
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (psycopg.errors.NotNullViolation) null value in column "rating_dist_1" of relation "books" violates not-null constraint
DETAIL:  Failing row contains (1, W.C. Fields: A Life on Film, null, null, null, null, null, null, 2026-02-18 13:59:11.774647+00, null, 1984, https://images.gr-assets.com/books/1310220028m/5333265.jpg, 1950356, null, null).
[SQL: INSERT INTO books (title, description, image_url, publication_year, book_id, author_id, similar_books) VALUES (%(title)s::VARCHAR, %(description)s::VARCHAR, %(image_url)s::VARCHAR, %(publication_year)s::INTEGER, %(book_id)s::VARCHAR, %(author_id)s::VARCHAR, %(similar_books)s::VARCHAR) RETURNING books.id, books.created_at]
[parameters: {'title': 'W.C. Fields: A Life on Film', 'description': None, 'image_url': 'https://images.gr-assets.com/books/1310220028m/5333265.jpg', 'publication_year': 1984, 'book_id': '1950356', 'author_id': None, 'similar_books': None}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
Failed to process row: {'language_code': '', 'popular_shelves': [{'count': '72', 'name': 'to-read'}, {'count': '18', 'name': 'picture-books'}, {'count': '18', 'name': 'animals'}, {'count': '17', 'name': 'picture-book'}, {'count': '14', 'name': 'cooking'}, {'count': '14', 'name': 'food'}, {'count': '9', 'name': 'childrens'}, {'count': '8', 'name': 'children-s-books'}, {'count': '6', 'name': 'children-s-picture-books'}, {'count': '6', 'name': 'children'}, {'count': '5', 'name': 'kids'}, {'count': '5', 'name': 'humor'}, {'count': '4', 'name': 'kids-picture-books'}, {'count': '4', 'name': 'kids-books'}, {'count': '4', 'name': 'math'}, {'count': '4', 'name': 'favorites'}, {'count': '4', 'name': 'currently-reading'}, {'count': '4', 'name': 'books-i-own'}, {'count': '3', 'name': 'farm'}, {'count': '3', 'name': 'animal'}, {'count': '3', 'name': 'chickens'}, {'count': '3', 'name': 'preschool'}, {'count': '2', 'name': 'school-library'}, {'count': '2', 'name': 'fantasy-4'}, {'count': '2', 'name': 'fractured-fairy-tales'}, {'count': '2', 'name': 'default'}, {'count': '2', 'name': 'edrd-314'}, {'count': '2', 'name': 'children-s-literature'}, {'count': '2', 'name': 'farm-animals'}, {'count': '2', 'name': 'childrens-picture-book'}, {'count': '2', 'name': 'fairy-tale'}, {'count': '2', 'name': 'read-alouds'}, {'count': '2', 'name': 'mom-read'}, {'count': '2', 'name': 'informational'}, {'count': '2', 'name': 'team-work'}, {'count': '2', 'name': 'read-aloud'}, {'count': '2', 'name': 'childrens-picture-books'}, {'count': '2', 'name': 'children-picture-books'}, {'count': '2', 'name': 'from-library'}, {'count': '2', 'name': 'teamwork'}, {'count': '2', 'name': 'funny'}, {'count': '2', 'name': 'picturebooks'}, {'count': '2', 'name': 'children-s'}, {'count': '2', 'name': 'children-s-lit'}, {'count': '1', 'name': 'awards-bluebonnet'}, {'count': '1', 'name': 'library-book'}, {'count': '1', 'name': 'childrens-books'}, {'count': '1', 'name': 'lae3005'}, {'count': '1', 'name': 'child-lit'}, {'count': '1', 'name': 'homeschool-read-w-kids-2016'}, {'count': '1', 'name': 'recipe'}, {'count': '1', 'name': 'dessert'}, {'count': '1', 'name': 'readit'}, {'count': '1', 'name': 'storytelling'}, {'count': '1', 'name': 'read-gone'}, {'count': '1', 'name': 'elementary-younger'}, {'count': '1', 'name': 'fairy-tale-books'}, {'count': '1', 'name': 'young-readers'}, {'count': '1', 'name': 'book'}, {'count': '1', 'name': 'pre-school'}, {'count': '1', 'name': 'youth-books'}, {'count': '1', 'name': 'preschool-list'}, {'count': '1', 'name': 'rdng-350-books'}, {'count': '1', 'name': 'have-it'}, {'count': '1', 'name': 'forth-100-books'}, {'count': '1', 'name': 'texas-bluebonnet-winners'}, {'count': '1', 'name': '250-picture-books'}, {'count': '1', 'name': 'children-s-books-read'}, {'count': '1', 'name': 'audio-cd'}, {'count': '1', 'name': 'picture-books-2017'}, {'count': '1', 'name': 'el-230-b'}, {'count': '1', 'name': 'read-in-2016'}, {'count': '1', 'name': 'pic-books-animals'}, {'count': '1', 'name': 'vocabulary'}, {'count': '1', 'name': 'procedure'}, {'count': '1', 'name': 'compare-and-contrast'}, {'count': '1', 'name': 'what-i-have-read-2017'}, {'count': '1', 'name': 'delani'}, {'count': '1', 'name': 'maya-read'}, {'count': '1', 'name': 'in-the-collection'}, {'count': '1', 'name': 'ar-2nd-red-dot'}, {'count': '1', 'name': 'to'}, {'count': '1', 'name': 'bubbles'}, {'count': '1', 'name': 'traditional-lit'}, {'count': '1', 'name': 'retellings'}, {'count': '1', 'name': 'l'}, {'count': '1', 'name': 'informative'}, {'count': '1', 'name': 'cookbooks-food'}, {'count': '1', 'name': 'by-general-fiction'}, {'count': '1', 'name': 'picture-books-young-children'}, {'count': '1', 'name': 'first-grade-read-alouds'}, {'count': '1', 'name': 'based-on-classic-lit'}, {'count': '1', 'name': 'award-or-honor-book'}, {'count': '1', 'name': 'author-visit'}, {'count': '1', 'name': 'author-i-liked'}, {'count': '1', 'name': 'animals-as-characters'}, {'count': '1', 'name': 'class'}, {'count': '1', 'name': 'cooking-with-children'}, {'count': '1', 'name': 'recipe-picture-books'}, {'count': '1', 'name': 'fiction-picture-books'}], 'similar_books': [343620, 586507, 470410, 780201, 82098, 1086593, 333152, 130459, 663846, 173478, 554317, 184773, 81323, 105416, 328052, 268865, 427442, 333909], 'description': "Big Brown Rooster is sick of chicken feed. So along with his friends--Turtle, Iguana, and Potbellied Pig--he sets out to make the most magnificent strawberry shortcake in the whole wide world. But there's one problem: none of his friends knows how to cook! The team bravely forges ahead, and with Rooster's help, they learn how to measure flour (not with a ruler) and how to beat an egg (not with a baseball bat). But can they keep Pig from gobbling up all the ingredients? Take an old family recipe, add four funny friends, and mix in some hilarious cooking confusion and you have a picture book treat for children of all ages!", 'format': 'Paperback', 'link': 'https://www.goodreads.com/book/show/1038901.Cook_a_Doodle_Doo_', 'authors': [{'author_id': '22372', 'role': ''}, {'author_id': '63610', 'role': ''}], 'publisher': 'HMH Books for Young Readers', 'num_pages': 48, 'isbn13': '9780152056582', 'publication_year': 2005, 'url': 'https://www.goodreads.com/book/show/1038901.Cook_a_Doodle_Doo_', 'image_url': 'https://s.gr-assets.com/assets/nophoto/book/111x148-bcc042a9c91a29c1d680899eff700a03.png', 'book_id': 565243, 'work_id': '2933269', 'title': 'Cook-a-Doodle-Doo!', 'num_interactions': 74, 'num_read': 49, 'num_ratings': 48, 'num_reviews': 16}
Traceback (most recent call last):
  File "/Users/borisgans/IE/chatbots/project/BookDB/bookdb/datasets/processor.py", line 348, in import_books
    book = BookCRUD.create(session, **book_data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/borisgans/IE/chatbots/project/BookDB/bookdb/datasets/crud.py", line 103, in create
    session.flush()
  File "/Users/borisgans/IE/chatbots/project/BookDB/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/Users/borisgans/IE/chatbots/project/BookDB/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4423, in _flush
    flush_context.transaction = transaction = self._autobegin_t()._begin()
                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _begin
  File "/Users/borisgans/IE/chatbots/project/BookDB/.venv/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 101, in _go
    self._raise_for_prerequisite_state(fn.__name__, current_state)
  File "/Users/borisgans/IE/chatbots/project/BookDB/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 971, in _raise_for_prerequisite_state
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (psycopg.errors.NotNullViolation) null value in column "rating_dist_1" of relation "books" violates not-null constraint
DETAIL:  Failing row contains (1, W.C. Fields: A Life on Film, null, null, null, null, null, null, 2026-02-18 13:59:11.774647+00, null, 1984, https://images.gr-assets.com/books/1310220028m/5333265.jpg, 1950356, null, null).
[SQL: INSERT INTO books (title, description, image_url, publication_year, book_id, author_id, similar_books) VALUES (%(title)s::VARCHAR, %(description)s::VARCHAR, %(image_url)s::VARCHAR, %(publication_year)s::INTEGER, %(book_id)s::VARCHAR, %(author_id)s::VARCHAR, %(similar_books)s::VARCHAR) RETURNING books.id, books.created_at]
[parameters: {'title': 'W.C. Fields: A Life on Film', 'description': None, 'image_url': 'https://images.gr-assets.com/books/1310220028m/5333265.jpg', 'publication_year': 1984, 'book_id': '1950356', 'author_id': None, 'similar_books': None}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
Failed to process row: {'language_code': '', 'popular_shelves': [{'count': '1462', 'name': 'to-read'}, {'count': '55', 'name': 'currently-reading'}, {'count': '30', 'name': 'historical-fiction'}, {'count': '30', 'name': 'fiction'}, {'count': '6', 'name': 'historical'}, {'count': '6', 'name': 'first-reads'}, {'count': '4', 'name': 'kindle'}, {'count': '4', 'name': 'book-club'}, {'count': '4', 'name': 'favorites'}, {'count': '3', 'name': 'debut-novel'}, {'count': '3', 'name': 'family'}, {'count': '2', 'name': 'pennsylvania'}, {'count': '2', 'name': 'contemporary'}, {'count': '2', 'name': 'based-on-a-true-story'}, {'count': '2', 'name': 'e-books'}, {'count': '2', 'name': 'kaylie-jones-books'}, {'count': '2', 'name': 'maybe'}, {'count': '2', 'name': '21st-century'}, {'count': '2', 'name': 'my-ebooks'}, {'count': '2', 'name': 'adult-fiction'}, {'count': '1', 'name': 'to-finish'}, {'count': '1', 'name': 'tbr-historical-fic'}, {'count': '1', 'name': 'librarybook'}, {'count': '1', 'name': '2017reviews'}, {'count': '1', 'name': 'ya'}, {'count': '1', 'name': 'nook'}, {'count': '1', 'name': '007-reading-the-past'}, {'count': '1', 'name': '2017-goodreads-reading-challenge'}, {'count': '1', 'name': 'depressing'}, {'count': '1', 'name': 'never-finished'}, {'count': '1', 'name': 'book-club-books'}, {'count': '1', 'name': '000001-stand-alone-books'}, {'count': '1', 'name': 'consider'}, {'count': '1', 'name': 'summer-reading-ap'}, {'count': '1', 'name': '2017-book-suggestions'}, {'count': '1', 'name': 'on-my-iphone'}, {'count': '1', 'name': 'decided-not-to-read'}, {'count': '1', 'name': '2017-books'}, {'count': '1', 'name': 'to-check-from-library'}, {'count': '1', 'name': 'mfa'}, {'count': '1', 'name': 'historical-mystery'}, {'count': '1', 'name': 'good'}, {'count': '1', 'name': 'novel'}, {'count': '1', 'name': 'grief'}, {'count': '1', 'name': 'death-of-a-child'}, {'count': '1', 'name': 'coal-miners'}, {'count': '1', 'name': 'bookclub'}, {'count': '1', 'name': 'alcoholism'}, {'count': '1', 'name': '14'}, {'count': '1', 'name': '1-rank-2'}, {'count': '1', 'name': 'book-club-ideas'}, {'count': '1', 'name': 'nook-library'}, {'count': '1', 'name': 'unread-at-home'}, {'count': '1', 'name': 'want-to-read'}, {'count': '1', 'name': 'kindle-e-books'}, {'count': '1', 'name': 'maybes'}, {'count': '1', 'name': 'own-kindle'}, {'count': '1', 'name': 'kindle-must-read'}, {'count': '1', 'name': 'to-read-ebook-sooner'}, {'count': '1', 'name': 'ebook-nook'}, {'count': '1', 'name': 'own-not-read'}, {'count': '1', 'name': 'women'}, {'count': '1', 'name': 'marriage'}, {'count': '1', 'name': 'interlibrary-loan'}, {'count': '1', 'name': 'summer-reading'}, {'count': '1', 'name': 'debut'}, {'count': '1', 'name': 'challenge-ideas-2016'}, {'count': '1', 'name': 'reading-the-past'}, {'count': '1', 'name': 'kindle-library'}, {'count': '1', 'name': 'have'}, {'count': '1', 'name': 'from-shelfari'}, {'count': '1', 'name': 'recommended-books'}, {'count': '1', 'name': 'owned-and-unread'}, {'count': '1', 'name': '2016-reading-challenge'}, {'count': '1', 'name': 'books'}, {'count': '1', 'name': 's-shelf'}, {'count': '1', 'name': 'to-read-at-some-point'}, {'count': '1', 'name': 'coal-mining'}, {'count': '1', 'name': 'to-read-author-p-t'}, {'count': '1', 'name': 'to-read2'}, {'count': '1', 'name': '300-to-399-pages'}, {'count': '1', 'name': 'mystery'}, {'count': '1', 'name': 'modern'}, {'count': '1', 'name': 'pop-sugar-challenge'}, {'count': '1', 'name': 'so-many-books-so-little-time'}, {'count': '1', 'name': 'kindle-book'}, {'count': '1', 'name': 'in-my-virtual-bookself'}, {'count': '1', 'name': 'waiting-to-read'}, {'count': '1', 'name': 'literary-fiction'}, {'count': '1', 'name': 'gifts'}, {'count': '1', 'name': 'mental-health'}, {'count': '1', 'name': 'literary'}, {'count': '1', 'name': 'spirituality-and-religion'}, {'count': '1', 'name': 'literature-in-english'}, {'count': '1', 'name': 'friendship'}, {'count': '1', 'name': 'belle-epoque'}, {'count': '1', 'name': '20th-century-1900-to-1919'}, {'count': '1', 'name': 'small-town'}, {'count': '1', 'name': 'religious-subject-matter'}, {'count': '1', 'name': 'book-discussion'}], 'similar_books': [148425, 436108, 575900, 384283, 267475, 335786, 477563, 1160522, 524432, 431667, 176061, 358909, 888747, 70512, 1080925, 576277, 175630, 357757], 'description': 'Nominated for a 2014 Lime Award for Excellence in Fiction\nNamed a Best Book of Summer 2014 by Publishers Weekly\nNamed a Pick of the Week for the week of June 30th by Publishers Weekly\n"An earnest, well-done historical novel that skillfully blends fact and fiction."\n--Publishers Weekly\n"A profound story of how one unforeseen event may tear a family apart, but another can just as unexpectedly bring them back together again."\n--Publishers Weekly, Best Book of Summer 2014 Pick\n"Solomon enticingly described the novel Sing in the Morning, Cry at Nightby Barbara J. Taylor (Akashic), set in a coal-mining town in 1913, as \'one of those sit on the couch and don\'t bother me\' reads."\n--Shelf Awareness, NCIBA Spring Rep Picks\n"An absolute gem of a book filled with beautiful characters and classical writing techniques rarely seen in modern literature."\n--The Christian Manifesto, Top Fiction Pick of 2014\n"This story is at once poignant and hopeful, spiced up by such characters as Billy Sunday, the revivalist, and Grief, the specter who haunts Grace to the very edge of sanity. A rich debut."\n--Historical Novel Society\n"Like Dickens, the novel faces family tragedy, in this case the town blaming 8-year-old Violet Morgan for her older sister\'s death. As her parents fall victim to their own vices, Violet learns how to form her own friendships to survive."\n--Arts.Mic\n"A fantastic novel worthy of the greatest accolades. Writing a book about a historical event can be difficult, as is crafting a bestseller, but Barbara J. Taylor is successful at both."\n--Downtown Magazine\n"Taylor\'s careful attention to detail and her deep knowledge of the community and its people give the novel a welcome gravity."\n--The Columbus Dispatch\n"One of the most compelling books I\'ve ever read...a haunting story that will stay with the reader long after reading this novel."\n--Story Circle Book Reviews\n"Rave reviews are pouring in for this historical novel of a family tragedy."\n--The Halifax Reader, "6 New Books to Look for in July"\n"This well-written book is peopled with characters the reader can really care about and captures the feeling of a gritty twentieth century coal mining community."\n--Breakthrough, newsletter of the Osteogenesis Imperfecta Foundation\n"Like all good historical fiction, I learned from this novel."\n--Time 2 Read\n"This book has...prizewinner written all over it....Worth the read!"\n--I\'ve Read This\n"This haunting story of tragedy and hope in an early twentieth century mining town is...an expertly crafted arrow that shoots straight for the heart. Reminiscent of classics such as How Green Was My Valley...this book is a must-read for fans of character-driven, authentic historical fiction."\n--Amy Drown Blog\nAlmost everyone in town blames eight-year-old Violet Morgan for the death of her nine-year-old sister, Daisy. Sing in the Morning, Cry at Nightopens on September 4, 1913, two months after the Fourth of July tragedy. Owen, the girls\' father, "turns to drink" and abandons his family. Their mother Grace falls victim to the seductive powers of Grief, an imagined figure who has seduced her off-and-on since childhood. Violet forms an unlikely friendship with Stanley Adamski, a motherless outcast who works in the mines as a breaker boy. During an unexpected blizzard, Grace goes into premature labor at home and is forced to rely on Violet, while Owen is "off being saved" at a Billy Sunday Revival. Inspired by a haunting family story, Sing in the Morning, Cry at Nightblends real life incidents with fiction to show how grace can be found in the midst of tragedy.', 'format': 'Paperback', 'link': 'https://www.goodreads.com/book/show/18528195-sing-in-the-morning-cry-at-night', 'authors': [{'author_id': '8251728', 'role': ''}], 'publisher': 'Kaylie Jones Books', 'num_pages': 320, 'isbn13': '9781617752278', 'publication_year': 2014, 'url': 'https://www.goodreads.com/book/show/18528195-sing-in-the-morning-cry-at-night', 'image_url': 'https://images.gr-assets.com/books/1395772688m/18528195.jpg', 'book_id': 310620, 'work_id': '26233831', 'title': 'Sing in the Morning, Cry at Night', 'num_interactions': 379, 'num_read': 81, 'num_ratings': 78, 'num_reviews': 28}
Traceback (most recent call last):
  File "/Users/borisgans/IE/chatbots/project/BookDB/bookdb/datasets/processor.py", line 348, in import_books
    book = BookCRUD.create(session, **book_data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/borisgans/IE/chatbots/project/BookDB/bookdb/datasets/crud.py", line 103, in create
    session.flush()
  File "/Users/borisgans/IE/chatbots/project/BookDB/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/Users/borisgans/IE/chatbots/project/BookDB/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4423, in _flush
    flush_context.transaction = transaction = self._autobegin_t()._begin()
                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _begin
  File "/Users/borisgans/IE/chatbots/project/BookDB/.venv/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 101, in _go
    self._raise_for_prerequisite_state(fn.__name__, current_state)
  File "/Users/borisgans/IE/chatbots/project/BookDB/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 971, in _raise_for_prerequisite_state
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (psycopg.errors.NotNullViolation) null value in column "rating_dist_1" of relation "books" violates not-null constraint
DETAIL:  Failing row contains (1, W.C. Fields: A Life on Film, null, null, null, null, null, null, 2026-02-18 13:59:11.774647+00, null, 1984, https://images.gr-assets.com/books/1310220028m/5333265.jpg, 1950356, null, null).
[SQL: INSERT INTO books (title, description, image_url, publication_year, book_id, author_id, similar_books) VALUES (%(title)s::VARCHAR, %(description)s::VARCHAR, %(image_url)s::VARCHAR, %(publication_year)s::INTEGER, %(book_id)s::VARCHAR, %(author_id)s::VARCHAR, %(similar_books)s::VARCHAR) RETURNING books.id, books.created_at]
[parameters: {'title': 'W.C. Fields: A Life on Film', 'description': None, 'image_url': 'https://images.gr-assets.com/books/1310220028m/5333265.jpg', 'publication_year': 1984, 'book_id': '1950356', 'author_id': None, 'similar_books': None}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)
Failed to process row: {'language_code': '', 'popular_shelves': [{'count': '17', 'name': 'to-read'}, {'count': '6', 'name': 'plays'}, {'count': '2', 'name': 'currently-reading'}, {'count': '1', 'name': 'comedy'}, {'count': '1', 'name': 'american'}, {'count': '1', 'name': 'plays-21st-century'}, {'count': '1', 'name': 'arts-plays'}, {'count': '1', 'name': '1-own'}, {'count': '1', 'name': 'jewish-fiction'}, {'count': '1', 'name': 'scripts'}, {'count': '1', 'name': 'dnf'}, {'count': '1', 'name': 'forsale'}, {'count': '1', 'name': 'books'}, {'count': '1', 'name': 'plays-2015'}, {'count': '1', 'name': 'script'}, {'count': '1', 'name': 'jewish'}, {'count': '1', 'name': 'theatre'}, {'count': '1', 'name': 'theater'}, {'count': '1', 'name': 'award-winning'}], 'similar_books': [], 'description': '"As eccentric as it is cunning, Greenberg\'s densely packed script sends your mind spinning while you laugh... Diffidence has rarely provided an audience with such enthrallingly readable hidden agendas." - Michael Feingold, Village Voice\n"The Assembled Partiesis Greenberg\'s most richly emotional work in years, and the most beautifully detailed." - Jesse Green, New York\n"This tragicomedy shocks us into realizing how hungry we have been for witty and wounded grownups who toss off gorgeously written observations without knowing how little we know about what we think we know." - Linda Winer, Newsday\nMeet the Bascovs, an Upper West Side Jewish family in 1980. In an opulent apartment overlooking Central Park, former movie star Julie and her sister-in-law Faye bring their families together for a traditional holiday dinner on a night when things don\'t go as planned. Twenty years later, as 2001 approaches, the Bascovs\' life may be about to crumble. An incisive portrait of a family grasping for stability at the dawn of a new millennium, The Assembled Partiespremiered on Broadway in 2013 to rave reviews and a Tony Award nomination for Best Play.\nRichard Greenberghas written two dozen plays, including Take Me Out(Tony Award for Best Play), The Dazzle(Outer Critics Circle Award), Three Days of Rain(L.A. Drama Critics Award, Pulitzer Prize finalist), The American Planand the book for a musical adaptation of Far from Heaven. He has received the Oppenheimer Award for a new playwright as well as the first PEN/Laura Pels Award for a playwright in midcareer.', 'format': 'Paperback', 'link': 'https://www.goodreads.com/book/show/18528196-the-assembled-parties', 'authors': [{'author_id': '76332', 'role': ''}], 'publisher': 'Theatre Communications Group', 'num_pages': 112, 'isbn13': '9781559364768', 'publication_year': 2015, 'url': 'https://www.goodreads.com/book/show/18528196-the-assembled-parties', 'image_url': 'https://images.gr-assets.com/books/1416445877m/18528196.jpg', 'book_id': 1607761, 'work_id': '26233832', 'title': 'The Assembled Parties', 'num_interactions': 14, 'num_read': 8, 'num_ratings': 7, 'num_reviews': 1}
Traceback (most recent call last):
  File "/Users/borisgans/IE/chatbots/project/BookDB/bookdb/datasets/processor.py", line 348, in import_books
    book = BookCRUD.create(session, **book_data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/borisgans/IE/chatbots/project/BookDB/bookdb/datasets/crud.py", line 103, in create
    session.flush()
  File "/Users/borisgans/IE/chatbots/project/BookDB/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
  File "/Users/borisgans/IE/chatbots/project/BookDB/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 4423, in _flush
    flush_context.transaction = transaction = self._autobegin_t()._begin()
                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _begin
  File "/Users/borisgans/IE/chatbots/project/BookDB/.venv/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py", line 101, in _go
    self._raise_for_prerequisite_state(fn.__name__, current_state)
  File "/Users/borisgans/IE/chatbots/project/BookDB/.venv/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 971, in _raise_for_prerequisite_state
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (psycopg.errors.NotNullViolation) null value in column "rating_dist_1" of relation "books" violates not-null constraint
DETAIL:  Failing row contains (1, W.C. Fields: A Life on Film, null, null, null, null, null, null, 2026-02-18 13:59:11.774647+00, null, 1984, https://images.gr-assets.com/books/1310220028m/5333265.jpg, 1950356, null, null).
[SQL: INSERT INTO books (title, description, image_url, publication_year, book_id, author_id, similar_books) VALUES (%(title)s::VARCHAR, %(description)s::VARCHAR, %(image_url)s::VARCHAR, %(publication_year)s::INTEGER, %(book_id)s::VARCHAR, %(author_id)s::VARCHAR, %(similar_books)s::VARCHAR) RETURNING books.id, books.created_at]
[parameters: {'title': 'W.C. Fields: A Life on Film', 'description': None, 'image_url': 'https://images.gr-assets.com/books/1310220028m/5333265.jpg', 'publication_year': 1984, 'book_id': '1950356', 'author_id': None, 'similar_books': None}]
(Background on this error at: https://sqlalche.me/e/20/gkpj) (Background on this error at: https://sqlalche.me/e/20/7s2a)